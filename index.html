<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>P√°gina Oficial de Download UniTV</title>

<!-- Carregamento do Tailwind CSS para a estiliza√ß√£o -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Defini√ß√£o de estilos e classes personalizadas (Dark Mode) -->
<style>
  /* Define a fonte Inter para o corpo do texto */
  body {
    font-family: 'Inter', sans-serif;
  }
  /* Estilo de fundo moderno com gradiente escuro */
  .modern-bg {
    background: linear-gradient(135deg, #1f2937 0%, #111827 100%); /* Fundo Escuro */
  }
  /* Estilos para os Cards de Download */
  .download-card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    background-color: #1f2937; /* Fundo do Card Escuro */
    border: 1px solid #374151; /* Borda Escura */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
  }
  .download-card:hover {
    /* Efeito de hover: Sombra mais proeminente e anel azul para Dark Mode */
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5), 0 0 0 3px #1e40af; 
    transform: translateY(-4px);
  }
  /* Bot√µes Secund√°rios (Manual e Sobre) - Estilo Dark Mode */
  .btn-secondary {
    border: 2px solid #3b82f6; /* Azul prim√°rio */
    color: #3b82f6; /* Cor do texto Azul */
    background-color: #1f2937; /* Fundo do Bot√£o Escuro */
    transition: background-color 0.3s ease, transform 0.2s ease;
  }
  .btn-secondary:hover {
    background-color: #374151; /* Fundo hover mais escuro */
    transform: translateY(-2px);
  }
  /* Estilo para o bot√£o flutuante do WhatsApp */
  .btn-whatsapp-float {
    transition: transform 0.3s ease;
  }
  .btn-whatsapp-float:hover {
    transform: scale(1.05);
  }
</style>
</head>
<body class="modern-bg min-h-screen flex items-center justify-center p-4 flex-col">

<!-- Container Principal (Centralizado e com tema escuro) -->
<main aria-label="Conte√∫do principal da p√°gina" class="w-full max-w-4xl bg-gray-900 rounded-3xl shadow-2xl p-6 sm:p-10 text-center border border-gray-700" id="main-content" role="main">
  <header>
    <!-- Logotipo UniTV (Imagem Externa) -->
    <div class="mx-auto mb-6 rounded-full border-4 border-blue-400 shadow-lg p-1 w-24 h-24 overflow-hidden bg-gray-800 flex items-center justify-center">
      <img 
        src="https://www.novacanaapage.com.br/uploads/images/hy9jsh5nunuc11p2v4dy3hy7e5ed/w_1600/Design-sem-nome--18-.png" 
        alt="Logotipo UniTV oficial" 
        class="w-full h-full object-cover"
        onerror="this.onerror=null;this.src='https://placehold.co/96x96/0056b3/ffffff?text=Logo+UniTV'"
      />
    </div>
    <h1 class="text-4xl font-extrabold text-white mb-2">Download Oficial UniTV</h1>
    <p class="text-gray-300 mb-10 text-lg">Escolha seu dispositivo e comece a assistir em minutos. **Instala√ß√£o r√°pida e segura.**</p>
  </header>

  <!-- Sec√ß√£o Principal: Links de Download (Layout de Cart√µes Visuais) -->
  <section aria-labelledby="download-title" class="mb-10">
    <h2 class="text-2xl font-bold text-white mb-6 text-center" id="download-title">Selecione seu Dispositivo</h2>
    
    <!-- Grid com 3 colunas para dispositivos maiores -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      
      <!-- Card para Celular Android -->
      <a aria-label="Baixar para Celular Android" class="download-card flex flex-col items-center p-6 rounded-2xl text-white hover:text-blue-400" href="http://zipa.la/unibox" rel="noopener noreferrer" role="link" target="_blank" id="btn-android">
        <span class="text-5xl mb-3 text-green-400">
          <!-- √çcone de Celular (SVG) -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
            <line x1="12" y1="18" x2="12" y2="18"></line>
          </svg>
        </span>
        <h3 class="font-bold text-xl mb-1">Android (Celular/Tablet)</h3>
        <p class="text-sm text-gray-400">Para assistir em movimento. Vers√£o ideal para telas menores.</p>
        <span class="mt-4 inline-block px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg text-sm shadow-md hover:bg-blue-700">BAIXAR APK</span>
      </a>

      <!-- Card para TV Box / Dispositivos Maiores -->
      <a aria-label="Baixar para TV Box" class="download-card flex flex-col items-center p-6 rounded-2xl text-white hover:text-blue-400" href="http://zipa.la/unibox" rel="noopener noreferrer" role="link" target="_blank" id="btn-tvbox">
        <span class="text-5xl mb-3 text-blue-400">
          <!-- √çcone de Televis√£o (SVG) -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect>
            <polyline points="17 2 12 7 7 2"></polyline>
          </svg>
        </span>
        <h3 class="font-bold text-xl mb-1">TV Box / Smart TV Android</h3>
        <p class="text-sm text-gray-400">Recomendado para tela grande e controle remoto. Melhor qualidade.</p>
        <span class="mt-4 inline-block px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg text-sm shadow-md hover:bg-blue-700">BAIXAR APK</span>
      </a>

      <!-- Card para Fire TV -->
      <a aria-label="Baixar para Fire TV" class="download-card flex flex-col items-center p-6 rounded-2xl text-white hover:text-blue-400" href="http://zipa.la/unibox" rel="noopener noreferrer" role="link" target="_blank" id="btn-firetv">
        <span class="text-5xl mb-3 text-red-400">
          <!-- √çcone de Fogo (Representando Fire TV Stick) (SVG) -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M10.8 17.5c-.8.8-1.7 1.2-2.7 1.2-1.2 0-2.3-.6-3-1.6 0-3.3 3.3-5.2 3.3-5.2s.5-3.3-1.5-5.2C5.3 4.6 6.3 3 8 3c2.7 0 4.3 2.5 4.3 2.5.8 1.5 1.7 2.5 2.7 2.5 1.2 0 2.3-.6 3-1.6 0 3.3-3.3 5.2-3.3 5.2s-.5 3.3 1.5 5.2c.7 1.2-.3 2.8-2 2.8-2.7 0-4.3-2.5-4.3-2.5z"></path>
          </svg>
        </span>
        <h3 class="font-bold text-xl mb-1">Amazon Fire Stick/TV</h3>
        <p class="text-sm text-gray-400">Otimizado para a linha de aparelhos Amazon, f√°cil de usar com controle.</p>
        <span class="mt-4 inline-block px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg text-sm shadow-md hover:bg-blue-700">BAIXAR APK</span>
      </a>
    </div>
  </section>
  
  <!-- Banner Web (Acesso direto via navegador) -->
  <section aria-labelledby="banner-title" class="mb-10">
    <a aria-label="UniTV Web chegou - abrir uvweboficial.com" class="w-full inline-flex items-center justify-center px-6 py-4 rounded-2xl bg-gradient-to-r from-purple-600 to-pink-500 text-white font-extrabold shadow-lg hover:opacity-95 focus:outline-none focus:ring-2 focus:ring-purple-300" href="https://www.uvweboficial.com" rel="noopener noreferrer" role="link" target="_blank">
      <span aria-hidden="true" class="mr-3 text-2xl">üñ•Ô∏è</span>
      <span id="banner-title">ASSISTA NO NAVEGADOR! ‚Äî UniTV Web chegou</span>
    </a>
  </section>

  <!-- Sec√ß√£o de Sugest√£o de Conte√∫do com Gemini API (CURADOR) -->
  <section aria-labelledby="ai-suggestion-title" class="mb-10 p-6 bg-yellow-900/30 rounded-2xl border border-yellow-800 shadow-md">
    <h2 class="text-xl font-bold text-white mb-4" id="ai-suggestion-title">Curador IA UniTV</h2>
    <button class="w-full inline-flex items-center justify-center px-6 py-3 bg-yellow-500 text-white font-semibold rounded-xl shadow-lg hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400 disabled:opacity-50 transition duration-300" id="generate-suggestion-btn" onclick="generateSuggestion()">
      <span aria-hidden="true" class="mr-2 text-xl">‚ú®</span>
      Gerar Sugest√£o de Conte√∫do
    </button>
    
    <!-- √Årea de Resultados e Loading (Layout Flex para Imagem e Texto) -->
    <div class="mt-4 p-4 bg-gray-800 rounded-lg border border-gray-700 min-h-32 relative flex flex-col md:flex-row items-center md:items-start" id="gemini-suggestion-wrapper">
      
      <!-- Container da Capa (Capa usa placeholder din√¢mico) -->
      <div class="w-32 h-48 flex-shrink-0 mb-4 md:mb-0 md:mr-4">
          <!-- Placeholder de Imagem para a Capa -->
          <img id="suggestion-image" src="https://placehold.co/150x225/A0AEC0/ffffff?text=Capa" class="rounded-lg shadow-md w-full h-full object-cover" alt="Capa do conte√∫do sugerido"/>
      </div>
      
      <!-- Container do Texto da Sugest√£o -->
      <div class="w-full text-center md:text-left">
          <h3 id="suggestion-title" class="text-xl font-extrabold text-white mb-1">Curador UniTV</h3>
          <p id="suggestion-details" class="text-sm font-semibold text-yellow-400 mb-2">Pronto para a sua sugest√£o!</p>
          <p class="text-gray-300 text-sm" id="suggestion-text">Clique no bot√£o acima para receber uma sugest√£o personalizada do nosso Curador IA!</p>
      </div>

      <!-- Spinner de Loading (Vis√≠vel apenas durante a chamada √† API) -->
      <div id="loading-spinner" class="hidden absolute inset-0 bg-gray-800 bg-opacity-80 flex items-center justify-center rounded-lg">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-400"></div>
        <p class="ml-3 text-yellow-400 font-semibold">A pensar na melhor sugest√£o...</p>
      </div>
    </div>
  </section>

  <!-- Sec√ß√£o de Suporte R√°pido com Gemini API (FAQ Interativa) -->
  <section aria-labelledby="ai-faq-title" class="mb-10 p-6 bg-blue-900/30 rounded-2xl border border-blue-800 shadow-md">
      <h2 class="text-xl font-bold text-white mb-4" id="ai-faq-title">Assistente de Suporte R√°pido IA</h2>
      <p class="text-gray-300 mb-4 text-sm">Tem d√∫vidas sobre **instala√ß√£o**, **ativa√ß√£o** ou **funcionalidades**? Pergunte √† nossa IA!</p>
      
      <!-- Input e Bot√£o de Pergunta (Layout flex√≠vel para mobile/desktop) -->
      <div class="flex flex-col sm:flex-row gap-3">
        <input type="text" id="faq-input" placeholder="Ex: Preciso de internet para usar o Playback?" class="w-full p-3 bg-gray-900 text-white border border-blue-700 rounded-xl focus:ring-blue-500 focus:border-blue-500 transition duration-150" aria-label="Introduza a sua quest√£o sobre o UniTV">
        <button class="flex-shrink-0 px-6 py-3 bg-blue-600 text-white font-semibold rounded-xl shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 disabled:opacity-50 transition duration-300" id="ask-faq-btn" onclick="askFAQ()">
          <span class="mr-1 text-xl">üí¨</span>
          Perguntar √† IA
        </button>
      </div>

      <!-- √Årea de Resposta e Loading do FAQ -->
      <div class="mt-4 text-left p-3 bg-gray-800 rounded-lg border border-gray-700 min-h-16 relative" id="faq-answer-wrapper">
        <p class="text-gray-400 text-sm italic" id="faq-answer-text">Aguardando a sua quest√£o...</p>
        <div id="faq-loading-spinner" class="hidden absolute inset-0 bg-gray-800 bg-opacity-80 flex items-center justify-center rounded-lg">
          <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"></div>
          <p class="ml-3 text-blue-400 font-semibold">A procurar a resposta...</p>
        </div>
      </div>
  </section>

  <!-- Se√ß√µes Secund√°rias (Informa√ß√µes Adicionais) -->
  <section class="divide-y divide-gray-700">
    <!-- Manual de Instala√ß√£o e Uso (Se√ß√£o Expans√≠vel) -->
    <div class="py-4">
      <button aria-controls="manual-content" aria-expanded="false" aria-label="Mostrar ou esconder o manual de instala√ß√£o e uso" class="btn-secondary inline-flex items-center justify-center w-full px-6 py-3 text-base font-semibold rounded-xl shadow-md" id="toggle-manual-btn" onclick="toggleManual()">
        <span aria-hidden="true" class="btn-icon mr-2">
          <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 19.5V15a2.5 2.5 0 0 1 5 0v4.5"></path>
            <path d="M19 19.5V15a2.5 2.5 0 0 0-5 0v4.5"></path>
            <rect height="6" rx="1" width="14" x="5" y="4"></rect>
          </svg>
        </span>
        <span class="btn-text">Ver Manual de Instala√ß√£o e Uso</span>
      </button>
      <p class="text-sm text-gray-400 mt-2">Instru√ß√µes r√°pidas, dicas e solu√ß√£o de problemas.</p>
      
      <!-- Conte√∫do do Manual (Vis√≠vel apenas quando expandido) -->
      <div aria-hidden="true" aria-labelledby="manual-title" class="hidden text-left pt-6" id="manual-content" role="region">
        <h2 class="text-xl font-bold text-white mb-4 pb-2">Guia Completo de Instala√ß√£o e Uso</h2>
        
        <!-- Bloco 1: Instala√ß√£o -->
        <div class="mb-4 p-4 bg-blue-900/30 rounded-lg shadow-inner border border-blue-800">
          <h3 class="font-bold text-blue-400 mb-2">1. Instala√ß√£o do Aplicativo</h3>
          <ul class="list-disc ml-5 text-sm text-gray-300 space-y-1">
            <li>Escolha o link de download compat√≠vel com seu dispositivo.</li>
            <li>Ap√≥s o download, abra o arquivo APK e permita a instala√ß√£o de fontes desconhecidas.</li>
            <li>Conclua a instala√ß√£o e abra o aplicativo UniTV.</li>
          </ul>
        </div>
        
        <!-- Bloco 2: Ativa√ß√£o -->
        <div class="mb-4 p-4 bg-green-900/30 rounded-lg shadow-inner border border-green-800">
          <h3 class="font-bold text-green-400 mb-2">2. Ativa√ß√£o e Login</h3>
          <ul class="list-disc ml-5 text-sm text-gray-300 space-y-1">
            <li>Insira o c√≥digo de ativa√ß√£o fornecido pela Capini Servi√ßos.</li>
            <li>Verifique se est√° conectado √† internet para validar o acesso.</li>
            <li>Ap√≥s o login, o conte√∫do ser√° liberado automaticamente.</li>
          </ul>
        </div>
        
        <!-- Bloco 3: Funcionalidades -->
        <div class="mb-4 p-4 bg-yellow-900/30 rounded-lg shadow-inner border border-yellow-800">
          <h3 class="font-bold text-yellow-400 mb-2">3. Funcionalidades Principais</h3>
          <ul class="list-disc ml-5 text-sm text-gray-300 space-y-1">
            <li>Mais de 65 canais em qualidade 4K (UHD).</li>
            <li>Playback dispon√≠vel por at√© 7 dias.</li>
            <li>Suporte a at√© 2 dispositivos simult√¢neos.</li>
            <li>Cat√°logo on-demand com filmes e s√©ries atualizados.</li>
            <li>Interface intuitiva com busca por nome, g√™nero e idioma.</li>
          </ul>
        </div>
        
        <!-- Bloco 4: Suporte/Dicas -->
        <div class="mb-4 p-4 bg-red-900/30 rounded-lg shadow-inner border border-red-800">
          <h3 class="font-bold text-red-400 mb-2">4. Dicas e Solu√ß√£o de Problemas</h3>
          <ul class="list-disc ml-5 text-sm text-gray-300 space-y-1">
            <li>Em caso de travamentos, verifique sua conex√£o de internet.</li>
            <li>Limpe o cache do aplicativo nas configura√ß√µes do dispositivo.</li>
            <li>Para suporte t√©cnico, utilize o bot√£o de WhatsApp dispon√≠vel na p√°gina.</li>
            <li>Atualiza√ß√µes s√£o feitas automaticamente ao abrir o aplicativo.</li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Sobre o UniTV (Se√ß√£o Expans√≠vel) -->
    <div class="py-4">
      <button aria-controls="sobre-content" aria-expanded="false" aria-label="Mostrar ou esconder informa√ß√µes sobre o UniTV" class="btn-secondary inline-flex items-center justify-center w-full px-6 py-3 text-base font-semibold rounded-xl shadow-md" id="toggle-sobre-btn" onclick="toggleSobre()">
        <span aria-hidden="true" class="btn-icon mr-2">
          <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 16h-1v-4h-1m1-4h.01M12 20h.01M12 4h.01" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
          </svg>
        </span>
        <span class="btn-text">Sobre o UniTV</span>
      </button>
      
      <!-- Conte√∫do Sobre o UniTV (Vis√≠vel apenas quando expandido) -->
      <div aria-hidden="true" aria-labelledby="toggle-sobre-btn" class="hidden text-left pt-6" id="sobre-content" role="region">
        <p class="text-sm text-gray-300 leading-relaxed mt-2">
          O UniTV pertence ao grupo HTV, uma empresa chinesa que atende em diversos pa√≠ses do mundo, dona tamb√©m do Tele Latino que √© vendido em pa√≠ses latinos e espanh√≥is, A-TV vendido nos Estados Unidos, YouCine e v√°rios outros aplicativos no mercado.
        </p>
        <p class="text-sm text-gray-300 leading-relaxed mt-2">
          O UniTV, por ser de uma empresa gigante, tem hoje o melhor custo-benef√≠cio do mercado, entregando boa qualidade e estabilidade aliado a um aplicativo completo com um excelente pre√ßo.
        </p>
        <p class="text-sm text-gray-300 leading-relaxed mt-2">
          Outro ponto forte do UniTV s√£o seus conte√∫dos on-demand, por se tratar de uma empresa antiga no mercado, possui um dos maiores cat√°logos de filmes e s√©ries.
        </p>
        <p class="text-sm text-gray-300 leading-relaxed mt-2">
          Al√©m disso, ressaltamos que ele possui tudo em um √∫nico aplicativo, ou seja, os canais ao vivo e os conte√∫dos on-demand no mesmo aplicativo, sem necessidade de instalar v√°rios aplicativos no aparelho.
        </p>
      </div>
    </div>
  </section>

</main>

<!-- Rodap√© -->
<footer class="text-center text-sm text-gray-400 py-4 mt-8">
  ¬© 2025 Capini Servi√ßos. Todos os direitos reservados.
  <p class="text-xs text-gray-500 mt-1">Vers√£o v1.0.8 (Dark Mode)</p>
</footer>

<!-- Bot√£o flutuante de Suporte (WhatsApp) -->
<a aria-label="Suporte via WhatsApp" class="btn-whatsapp-float fixed bottom-6 right-6 bg-green-500 text-white px-4 py-3 rounded-full shadow-lg flex items-center gap-2 z-50 hover:bg-green-600" href="https://wa.me/5521985444844?text=Ol%C3%A1%2C+preciso+de+ajuda+com+o+UniTV." rel="noopener" target="_blank">
  <!-- √çcone de bal√£o de mensagem do WhatsApp -->
  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M8 12h.01M12 12h.01M16 12h.01" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
    <path d="M21 12.79A9 9 0 1111.21 3 9 9 0 0121 12.79z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
  </svg>
  Suporte
</a>

<!-- Bloco JavaScript Principal: Fun√ß√µes de Interatividade e Gemini API -->
<script>
  // A CHAVE DA API FOI FORNECIDA NA CONVERSA
  const apiKey = "AIzaSyDBFOpga6ek8jf0wG6quHc1akzwinMdIlA"; 
  // URL base para chamadas √† API Gemini (Modelo flash)
  const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

  /* --- Fun√ß√µes de Toggle (Expans√£o de Conte√∫do) --- */

  /**
   * Fun√ß√£o para alternar a visibilidade da se√ß√£o "Sobre o UniTV".
   */
  function toggleSobre() {
    const content = document.getElementById('sobre-content');
    const button = document.getElementById('toggle-sobre-btn');
    if (!content || !button) return;

    // Alterna a classe 'hidden'
    content.classList.toggle('hidden');
    const willShow = !content.classList.contains('hidden');

    // Atualiza atributos de acessibilidade (ARIA)
    button.setAttribute('aria-expanded', String(willShow));
    content.setAttribute('aria-hidden', String(!willShow));

    // Atualiza o texto do bot√£o
    const textSpan = button.querySelector('.btn-text');
    if (textSpan) textSpan.textContent = willShow ? 'Esconder informa√ß√µes' : 'Sobre o UniTV';

    // Rola para a se√ß√£o se ela for aberta
    if (willShow) content.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  /**
   * Fun√ß√£o para alternar a visibilidade da se√ß√£o "Manual de Instala√ß√£o e Uso".
   */
  function toggleManual() {
    const content = document.getElementById('manual-content');
    const button = document.getElementById('toggle-manual-btn');
    if (!content || !button) return;

    // Alterna a classe 'hidden'
    content.classList.toggle('hidden');
    const willShow = !content.classList.contains('hidden');

    // Atualiza atributos de acessibilidade (ARIA)
    button.setAttribute('aria-expanded', String(willShow));
    content.setAttribute('aria-hidden', String(!willShow));

    // Atualiza texto e √≠cone do bot√£o (Muda o √≠cone para 'X' ao abrir)
    const textSpan = button.querySelector('.btn-text');
    const iconSpan = button.querySelector('.btn-icon');
    if (textSpan) textSpan.textContent = willShow ? 'Esconder Manual' : 'Ver Manual de Instala√ß√£o e Uso';
    
    // Atualiza o √≠cone (Mostra 'X' ao abrir, √≠cone de livro ao fechar)
    if (iconSpan) {
      iconSpan.innerHTML = willShow
        ? `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`
        : `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5V15a2.5 2.5 0 0 1 5 0v4.5"/><path d="M19 19.5V15a2.5 2.5 0 0 0-5 0v4.5"/><rect x="5" y="4" width="14" height="6" rx="1"/></svg>`;
    }

    // Rola para a se√ß√£o se ela for aberta
    if (willShow) content.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }


  /* --- Fun√ß√µes Gemini (Curador de Conte√∫do) --- */

  /**
   * Mostra/Esconde o spinner de loading e desativa o bot√£o do Curador IA durante a chamada √† API.
   * @param {boolean} show - Se deve mostrar (true) ou esconder (false).
   */
  function toggleLoading(show) {
    const spinner = document.getElementById('loading-spinner');
    const button = document.getElementById('generate-suggestion-btn');
    if (show) {
      spinner.classList.remove('hidden');
      button.disabled = true; // Desativa o bot√£o para evitar cliques duplicados
    } else {
      spinner.classList.add('hidden');
      button.disabled = false; // Reativa o bot√£o
    }
  }

  /**
   * Fun√ß√£o utilit√°ria para gerar uma cor hex √∫nica e vibrante a partir de uma string (pseudo-aleat√≥ria).
   */
  function stringToColor(str) {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
          hash = str.charCodeAt(i) + ((hash << 5) - hash);
      }
      let color = '#';
      for (let i = 0; i < 3; i++) {
          let value = (hash >> (i * 8)) & 0xFF;
          // Garante que a cor √© clara o suficiente para bom contraste com texto branco
          value = (value + 128) % 256; 
          color += ('00' + value.toString(16)).substr(-2);
      }
      return color;
  }

  /**
   * Fun√ß√£o para criar o URL do placeholder de imagem (capa) com cor din√¢mica.
   * Isto simula puxar uma capa da internet de forma segura.
   * @param {string} title - T√≠tulo do conte√∫do para o texto da capa.
   * @returns {string} O URL do placeholder.
   */
  function createPlaceholderUrl(title) {
      // Gera uma cor de fundo √∫nica baseada no t√≠tulo
      const bgColor = stringToColor(title).substring(1); 
      const textColor = 'FFFFFF'; // Texto branco para alto contraste
      // Limita e sanitiza o t√≠tulo para o URL
      const sanitizedTitle = title.replace(/[\s\W]+/g, '+').substring(0, 20); 
      return `https://placehold.co/150x225/${bgColor}/${textColor}?text=${sanitizedTitle}`;
  }

  /**
   * Chama a API do Gemini para gerar uma sugest√£o de conte√∫do estruturada (JSON).
   */
  async function generateSuggestion() {
    toggleLoading(true);
    // Refer√™ncias aos elementos da UI
    const suggestionContainer = document.getElementById('suggestion-text');
    const titleContainer = document.getElementById('suggestion-title');
    const detailsContainer = document.getElementById('suggestion-details');
    const imageContainer = document.getElementById('suggestion-image');
    
    // Define estados iniciais de carregamento na UI
    titleContainer.textContent = "A pensar...";
    detailsContainer.textContent = "A Curadoria IA est√° a trabalhar...";
    suggestionContainer.textContent = "Aguarde, a melhor op√ß√£o est√° a caminho!";
    imageContainer.src = `https://placehold.co/150x225/A0AEC0/ffffff?text=A+Curar`;

    // System Prompt: define a persona e o formato de sa√≠da
    const systemPrompt = "Aja como um curador de conte√∫do especializado do UniTV. A sua resposta deve ser um objeto JSON que sugere um tipo de conte√∫do para assistir, baseado num estado de esp√≠rito. Mencione sempre um dos principais benef√≠cios do UniTV (4K, Playback, ou vasto cat√°logo On-Demand) no texto da sugest√£o. Responda em portugu√™s de Portugal (europeu).";
    const userQuery = "Sugere um t√≠tulo de conte√∫do fict√≠cio, o tipo ('Filme', 'S√©rie', ou 'Canal ao Vivo') e uma sugest√£o de texto concisa (m√°ximo 40 palavras).";

    // Estrutura JSON requerida (Schema)
    const jsonSchema = {
        type: "OBJECT",
        properties: {
            "title": { "type": "STRING", "description": "T√≠tulo fict√≠cio da sugest√£o (ex: 'Ca√ßa ao Tesouro', 'Tudo em Dia')." },
            "type": { "type": "STRING", "description": "Tipo de conte√∫do: 'Filme', 'S√©rie', ou 'Canal ao Vivo'." },
            "suggestion_text": { "type": "STRING", "description": "Par√°grafo conciso com a sugest√£o e men√ß√£o a um benef√≠cio (m√°ximo 40 palavras)." }
        },
        required: ["title", "type", "suggestion_text"]
    };

    const payload = {
      contents: [{ parts: [{ text: userQuery }] }],
      generationConfig: {
          responseMimeType: "application/json",
          responseSchema: jsonSchema
      },
      systemInstruction: {
        parts: [{ text: systemPrompt }]
      },
    };

    try {
      let response;
      let retries = 0;
      const maxRetries = 5;

      // Implementa√ß√£o do Backoff Exponencial para lidar com falhas tempor√°rias da rede/API
      while (retries < maxRetries) {
        response = await fetch(apiUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (response.ok) {
          break; // Sucesso
        }

        retries++;
        if (retries < maxRetries) {
          const delay = Math.pow(2, retries) * 1000;
          await new Promise(resolve => setTimeout(resolve, delay)); // Espera exponencial
        } else {
          throw new Error(`Falha na API ap√≥s ${maxRetries} tentativas.`);
        }
      }

      if (!response || !response.ok) {
        throw new Error('Falha ao obter sugest√£o da IA. C√≥digo de status: ' + (response ? response.status : 'N/A'));
      }

      const result = await response.json();
      // Extrai o texto JSON da resposta da API
      const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
      
      if (!jsonText) throw new Error("Resposta JSON vazia ou incompleta.");
      
      const suggestionData = JSON.parse(jsonText);

      // Atualiza a interface com os dados estruturados
      const title = suggestionData.title || "Sugest√£o Desconhecida";
      titleContainer.textContent = title;
      detailsContainer.textContent = `Tipo: ${suggestionData.type || 'N/A'}`;
      suggestionContainer.textContent = suggestionData.suggestion_text || "Sugest√£o de texto indispon√≠vel.";
      
      // Atualiza√ß√£o da capa com imagem din√¢mica
      imageContainer.src = createPlaceholderUrl(title);

    } catch (error) {
      console.error("Erro na gera√ß√£o de sugest√£o:", error);
      // Feedback de erro na UI
      titleContainer.textContent = "Erro de Conex√£o";
      detailsContainer.textContent = "Por favor, tente novamente.";
      suggestionContainer.textContent = "N√£o foi poss√≠vel carregar a sugest√£o. Certifique-se de que a API Key √© v√°lida.";
      imageContainer.src = `https://placehold.co/150x225/EF4444/FFFFFF?text=ERRO`;
    } finally {
      toggleLoading(false); // Esconde o spinner
    }
  }

  /* --- Fun√ß√µes Gemini (Assistente de Suporte R√°pido - FAQ) --- */

  /**
   * Mostra/Esconde o spinner de loading e desativa os controlos do FAQ.
   * @param {boolean} show - Se deve mostrar (true) ou esconder (false).
   */
  function toggleFAQLoading(show) {
    const spinner = document.getElementById('faq-loading-spinner');
    const button = document.getElementById('ask-faq-btn');
    const input = document.getElementById('faq-input');
    if (show) {
      spinner.classList.remove('hidden');
      button.disabled = true;
      input.disabled = true;
    } else {
      spinner.classList.add('hidden');
      button.disabled = false;
      input.disabled = false;
    }
  }

  /**
   * Chama a API do Gemini para responder a perguntas frequentes usando o conte√∫do da p√°gina como contexto.
   */
  async function askFAQ() {
    const question = document.getElementById('faq-input').value.trim();
    const answerContainer = document.getElementById('faq-answer-text');

    if (question === "") {
        answerContainer.textContent = "Por favor, introduza a sua quest√£o.";
        return;
    }
    
    toggleFAQLoading(true);
    answerContainer.textContent = "A procurar a resposta...";


    // Conte√∫do da p√°gina para contextualizar a resposta da IA (base de conhecimento)
    const context = `
        ### Manual de Instala√ß√£o e Uso
        1. Instala√ß√£o: Baixe o APK, abra e permita a instala√ß√£o de fontes desconhecidas.
        2. Ativa√ß√£o: Use o c√≥digo de ativa√ß√£o fornecido pela Capini Servi√ßos. Requer internet para validar.
        3. Funcionalidades: 65+ canais 4K (UHD), Playback (replay) de 7 dias, Suporte a 2 dispositivos simult√¢neos, Vasto Cat√°logo On-Demand (filmes e s√©ries).
        4. Suporte/Dicas: Em caso de travamentos, verifique a conex√£o ou limpe o cache. Suporte via WhatsApp. Atualiza√ß√µes s√£o autom√°ticas.
        
        ### Sobre UniTV
        O UniTV √© do grupo HTV (empresa chinesa), tem excelente custo-benef√≠cio e estabilidade. Possui conte√∫do ao vivo e On-Demand num √∫nico aplicativo.
    `;

    // System Prompt: define a persona (suporte) e restringe a resposta ao contexto
    const systemPrompt = `Aja como um agente de suporte t√©cnico amig√°vel para o UniTV. A sua tarefa √© responder √† quest√£o do utilizador de forma concisa (m√°ximo 50 palavras) e direta, utilizando **apenas** o contexto fornecido abaixo. Se a resposta n√£o estiver no contexto, responda que essa informa√ß√£o n√£o est√° dispon√≠vel. Responda em portugu√™s de Portugal.

    CONTEXTO:
    ${context}
    `;

    const userQuery = `Quest√£o: ${question}`;

    const payload = {
        contents: [{ parts: [{ text: userQuery }] }],
        systemInstruction: {
            parts: [{ text: systemPrompt }]
        },
    };

    try {
        let response;
        let retries = 0;
        const maxRetries = 5;

        // Implementa√ß√£o do Backoff Exponencial para o FAQ
        while (retries < maxRetries) {
            response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (response.ok) {
                break;
            }

            retries++;
            if (retries < maxRetries) {
                const delay = Math.pow(2, retries) * 1000;
                await new Promise(resolve => setTimeout(resolve, delay));
            } else {
                throw new Error(`Falha na API ap√≥s ${maxRetries} tentativas.`);
            }
        }

        if (!response || !response.ok) {
            throw new Error('Falha ao obter resposta da IA. C√≥digo de status: ' + (response ? response.status : 'N/A'));
        }

        const result = await response.json();
        const text = result.candidates?.[0]?.content?.parts?.[0]?.text || "Desculpe, a IA n√£o conseguiu processar a sua quest√£o neste momento.";
        
        // Exibe a resposta final
        answerContainer.textContent = text;

    } catch (error) {
        console.error("Erro na gera√ß√£o da FAQ:", error);
        answerContainer.textContent = "Erro ao contactar a IA. Por favor, tente novamente ou use o suporte via WhatsApp.";
    } finally {
        toggleFAQLoading(false); // Esconde o spinner e reativa os controlos
    }
  }
</script>
</body>
</html>
